# Описание работы сервиса оплаты
## Вводная часть
Проект представляет набор сервисов с платным использованием апи любого из них. Для этого реализован сервис оплаты. Перед использованием 
сервиса пользователь обязан оплатить его и получить токен доступа к оплаченному на определенный период функционалу. Все запросы к сервисам 
обязаны содержать такой токен доступа, а сервисы соответственно должен проверять валидность этого токена.  
## Описание API
API описаны при помощи openApi документации в следующих файлах:
- [service.yml](service.yml) - описание API сервиса оплаты для других сервисов проекта
- [client.yml](client.yml) - описание API сервиса оплаты для клиентов  
  
В удобном виде документация доступна по ссылке: [https://editor.swagger.io/](https://editor.swagger.io/)
## Последовательность действий клиента
1. Клиент отправляет запрос на составление счета на оплату, в которому он указывает период и список сервисов, которые он хочет использовать.
2. Сервис сформирует счет его вместе с артефактом оплаты. Далее все манипуляции с токеном будут обрабатываться через этот артефакт. Повторно его 
получить будет невозможно.
3. После необходимо оплатить счет, после успешной оплаты сервис сформирует токен доступа.
4. При необходимости токен можно будет обновить.
5. Токен необходимо будет использовать при вызове методов сервиса.
## Последовательность действий для сервисов проекта
1. Все методы сервиса должны принимать внутри запроса токен аутентификации. Рекомендуется принимать их в виде заголовка 
`Authorization: Bearer <token>`.
2. Для проверки доступа по переданному токену сервис должен обратиться к сервису оплаты по описанному API. Крайне рекомендуется кэшировать 
запросы к сервису оплаты, так как они могут быть вызваны довольно часто. Однако период хранения запросов должен быть не более 1 часа в связи с тем, 
что токен может быть деактивирован.
## При возникновении вопросов/проблем/предложений
Всегда готов пересмотреть сервис и внести изменения
- [Telegram](https://t.me/gribforyou)